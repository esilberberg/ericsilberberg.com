<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="lesson-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/nord.min.css">

    <link rel="icon" type="image/x-icon" href="media/favicon.ico">
    
    <script src="https://kit.fontawesome.com/1d9765704f.js" crossorigin="anonymous"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap" rel="stylesheet">

    <title>Build Your Own AI Tools: An Introduction to Gemini's API</title>
</head>
<body>
    <nav class="top-nav">
        <div class="top-nav-content">
            <a href="index.html"><i class="fa-solid fa-arrow-left"></i></a>
        </div>
    </nav>
    <main>
        <header>
            <h1 class="title">Build Your Own AI Tools:</h1>
            <h1 class="sub-title">An Introduction to Gemini's API</h1>
            <p>By Eric Silberberg, 2024</p>
        </header>
        <section class="welcome">
            <p>We've all used AI-powered chatbots: simple input, relevant output. But what if you could be the AI creator, not just the consumer?</p> 
            <p>In this tutorial you'll learn how to build your own AI tools using Google's Gemini <a href="https://en.wikipedia.org/wiki/Large_language_model" target="_blank" rel="noopener noreferrer">LLM</a>. You'll learn how to configure the Gemini API, incorporate Gemini into Python functions, and then use that function to manipulate large datasets. This is just an introduction; by the end, you'll be equipped to tackle bigger, more complex projects.</p>
            <p>To make the most of this tutorial, its recommended that you have a basic understanding of Python. If not, take some time with <a href="https://www.youtube.com/watch?v=f79MRyMsjrQ&t=1s" target="_blank" rel="noopener noreferrer">this tutorial</a> and come back when you understand objects and functions.</p>
        </section>
        <nav class="table-of-contents">
            <h2>Table of Contents</h2>
            <ul>
                <li><a href="#1">1. Defining the problem</a></li>
                <li><a href="#2">2. Installing Gemini 1.5 Flash</a></li>
                <li><a href="#3">3. Your first function with Gemini</a></li>
                <li><a href="#4">4. Rating student reviews with Gemini</a></li>
                <li><a href="#5">5. Iterating over a large dataset</a></li>
                <li><a href="#6">6. Where to go from here</a></li>
            </ul>
        </nav>
        <section class="lesson-content" id="1">
            <h3>1. Defining the problem</h3>
            <p>Analyzing student feedback can be difficult, especially with large classes and diverse responses: direct, exuberant, cagey, passive aggressive, ambiguous, etc. If we want to get a snapshot of students' opinions about a class, one way would be to rate their response based on sentiment. In other words, we could rate the overall positivity or negativity of each student's experience. Manually categorizing feedback by sentiment is time consuming. In this tutorial, we'll use Gemini to rate the positivity of student feedback on a scale of 1-5 and create a structured dataset. This will allow us to quickly identify trends and focus on specific areas for improvement. </p>
        </section>
        <section class="lesson-content" id="2">
            <h3>2. Installing Gemini 1.5 Flash</h3>
            <p>Gemini 1.5 Flash is Google’s free, lightweight LLM that can handle 10,000+ words in a prompt. To get started we'll need to register for a Gemini API key and install the Google's Generative AI Python library.</p>
            <ol>
                <li><p>Follow the <a href="https://ai.google.dev/gemini-api/docs/api-key" target="_blank" rel="noopener noreferrer">directions to generate your API key.</a> Once generated, copy and save the key in a new file on your computer called: <code class="file-name">gemini-api-key.txt</code> Do not share this key.</p></li>
                <li><p>Then pip install <a href="https://ai.google.dev/gemini-api/docs/downloads" target="_blank" rel="noopener noreferrer">Google's Generative AI Python library:</a></p></li>
            </ol> 
            <pre><code class="language-python">pip install google-generativeai</code></pre>
        </section>
        <section class="lesson-content" id="3">
            <h3>3. Your first function with Gemini</h3>
            <p>With everything installed, we’re ready to take Gemini for a test drive. Our first project will be an AI tool that creates an <a href="https://en.wikipedia.org/wiki/Anagram" target="_blank" rel="noopener noreferrer">anagram</a> of a person's name.</p>
            <p>Let's get our files organized. Create a new folder called <code class="file-name">my-ai-tool</code> and put the <code class="file-name">gemini-api-key.txt</code> file inside the folder. Create a new Python file in the folder and call it <code class="file-name">ai-tool.py</code> Your file structure should look like this:</p>
<pre>
    &mdash;&mdash; my-ai-tool
            &mdash; gemini-api-key.txt
            &mdash; anagram.py
</pre>
            <p>Inside the IDE of your choice, open <code class="file-name">anagram.py</code> and read your API key into memory. By printing the contents of <code class="file-name">gemini-api-key.txt</code> to the terminal, you can test that everything is in order:</p>

<pre><code class="language-python">with open('gemini-api-key.txt') as f:
    genai_api_key = f.read()

print(genai_api_key)
</code></pre>
            <p>Next, remove the print function, import Google's Generative AI library, and configure the language model. In just two short lines of code, you'll establish a connection to the Gemini API and create an object called "model" that can generate text with the gemini-1.5-flash LLM:</p>
<pre><code class="language-python">import google.generativeai as genai

with open('gemini-api-key.txt') as f:
    genai_api_key = f.read()

genai.configure(api_key=genai_api_key)
model = genai.GenerativeModel('gemini-1.5-flash')
</code></pre>
            <p>With Gemini configured, let's create a function that'll create anagrams using Gemini. We’ll start with a simple function called <code class="file-name">create_anagram(name)</code> that takes a person's name as input. Inside the function, we'll use <code class="file-name">model.generate_content()</code> to send a prompt to Gemini, asking it to generate an anagram based on the given name. I’m using a Python feature called an <a href="https://www.w3schools.com/python/python_string_formatting.asp" target="_blank" rel="noopener noreferrer">f-string (formatted string literals)</a> to add our function’s <code class="file-name">name</code> argument at the end of the prompt: Create one anagram with the letters in this person’s name: {name}.</p>
            <p>To retrieve the generated anagram as text, we'll use <code class="file-name">response.text</code>. If we omit the <code class="file-name">.text</code> attribute, the function will return metadata about the generated text.</p>
            <p>Let's try running the function with and without <code class="file-name">.text</code> to see the difference. What anagrams can we create for Albert Einstein?</p>
<pre><code class="language-python">def create_anagram(name):
    response = model.generate_content(f"Create one anagram with the letters in this person's name: {name}")
    return response.text

print(create_anagram("albert einstein"))
</code></pre>

        </section>
        <section class="lesson-content" id="4">
            <h3>4. Rating student reviews with Gemini</h3>
            <p>Now that we understand the basics of the Gemini API, let's build a new AI tool that analyzes student reviews for their sentiment.</p>
            <p>In the <code class="file-name">my-ai-tool</code> folder, create a new Python file called <code class="file-name">rate-sentiment.py</code>. Then download <a href="content-build-your-own-ai-tools/student-review-1.txt" download="student-review-1.txt">student-review-1.txt <i class="fa-solid fa-arrow-up-right-from-square"></i></a> and add it to the folder. Your file structure should look like this:</p> 
<pre>
    &mdash;&mdash; my-ai-tool
            &mdash; gemini-api-key.txt
            &mdash; anagram.py
            &mdash; student-review-1.txt
            &mdash; rate-sentiment.py
</pre>
                
                
            <p>Read this student review into memory and print it to the terminal as we did earlier with your API key: </p>
<pre><code class="language-python">with open('student-review-1.txt') as f:
    student_review = f.read()

print(student_review)
</code></pre>
            <p>When you run the above code, you should see this student review in the terminal:</p>
<pre><code class="language-plaintext">Stats class was definitely challenging, but I learned 
a lot! The teacher was helpful, and class discussions 
were interesting. However, I struggled with the
assignments. The instructions were often confusing,
and I spent way too much time trying to figure out
what was expected. I wish the assignments were more
clear-cut.
</code></pre>
            <p>On an individual basis, student reviews are nuanced and provide some meaningful feedback. But multiply this out by 50 or 100 times, and it becomes harder to understand whether students, in general, found a course useful.</p>
            <p>We can use Gemini to rate the sentiment of student reviews, which is to say quantify student reviews. A simple way to rate sentiment is with a Likert scale of 1-5, with 1 representing Very Negative and 5 representing Very Positive sentiment.</p>
            <p>Getting Gemini to rate sentiment effectively will take us into an area called prompt engineering, which is the process of crafting instructions to guide AI models towards desired outputs. Prompt engineering is an iterative process, so by refining our instructions we'll discover best practices for this process.</p>
            <p>Let's start by creating a function that will accept student feedback as a paragraph. This should look familiar from earlier:</p>
<pre><code class="language-python">import google.generativeai as genai

#Read Gemini API key into memory.
with open('gemini-api-key.txt') as f:
    genai_api_key = f.read()

#Read student review into memory.
with open('student-review-1.txt') as f:
    student_review = f.read()

#Configure API and select the Gemini 1.5 Flash language model.
genai.configure(api_key=genai_api_key)
model = genai.GenerativeModel('gemini-1.5-flash')

def rate_sentiment(text):
    """Rates the positivity of a text on scale of 1-5: 
    5 = Very Positive. 1 = Very Negative.
    """    
    response = model.generate_content() 
    return response.text

#Apply the function to our text file and see Gemini's response.
print(rate_sentiment(student_review))
</code></pre>
            <p>We can use this prompt: Rate the positivity of this student's review of a class on a scale of 1-5, with 1 representing Very Negative and 5 representing Very Positive. We can then use an <a href="https://www.w3schools.com/python/python_string_formatting.asp" target="_blank" rel="noopener noreferrer">f-string</a> again like this: </p>
<pre><code class="language-python">def rate_sentiment(text):
    """Rates the positivity of a text on scale of 1-5: 
    5 = Very Positive. 1 = Very Negative.
    """    
    response = model.generate_content(f"Rate the positivity of this student's review of a class on a scale of 1-5, with 1 representing Very Negative and 5 representing Very Positive: {text}") 
    return response.text

print(rate_sentiment(student_review))
</code></pre>
            <p>Run the code and you should get a response similar to this in the terminal:</p>
<pre><code class="language-plaintext">I would rate this review a **3/5**. 

Here's why:

* **Positive:** The student acknowledges learning a lot, appreciates the professor's helpfulness, and finds the class discussions engaging.
* **Neutral:**  The student's experience with the assignments is mixed. While they struggle, the student doesn't express outright dissatisfaction with the professor or the class.
* **Negative:**  The student explicitly expresses frustration with the assignment instructions and wishes they were clearer. 

Overall, the review is balanced, highlighting both positive and negative aspects. It's not overly enthusiastic but also not overtly critical.
</code></pre>
            <p>The good news is that Gemini understands the prompt and is giving us a meaningful response. However, for our purposes, we just need the Likert score and not the full justification. This is prompt engineering, and what we learned from Gemini's justified response is that we need to refine our prompt to be more specific about what is our desired output. Let's try this:</p>
<pre><code class="language-python">def rate_sentiment(text):
    """Rates the positivity of a text on scale of 1-5: 
    5 = Very Positive. 1 = Very Negative.
    """    
    response = model.generate_content(f"Rate the positivity of this student's review of a class on a scale of 1-5, with 1 representing Very Negative and 5 representing Very Positive. Your output should be in the form of a single digit representing your positivity score: {text}") 
    return response.text

print(rate_sentiment(student_review))
</code></pre>
            <p>Let's recap: We’ve successfully passed our data to Gemini, had it analyze that data for sentiment positivity, and refined the format of its output through prompt engineering. Next we’ll apply our <code class="file-name">rate_sentiment()</code> function to an entire set of student feedback. </p>
        </section>
        <section class="lesson-content" id="5">
            <h3>5. Iterating over a large dataset</h3>
        </section>
        <section class="lesson-content" id="6">
            <h3>6. Where to go from here</h3>
        </section>
    </main>






    <footer>
        <p>This lesson was made possible by the CUNY Office of Faculty Affairs' 2024 <a href="https://www.cuny.edu/academics/faculty-affairs/cuny-innovative-teaching-academy/building-bridges-of-knowledge-bbk/" target="_blank" rel="noopener noreferrer">Building Bridges of Knowledge</a> project.</p>
        <p>Lesson content on this page is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer">Creative Commons Attribution 4.0 International license</a></p>
        <i class="fa-brands fa-creative-commons"></i> <i class="fa-brands fa-creative-commons-by"></i>
    </footer>  


<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll()</script>
</body>
</html>